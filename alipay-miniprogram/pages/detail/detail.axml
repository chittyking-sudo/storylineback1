<view class="container">
  
  <!-- åŠ è½½ä¸­ -->
  <view a:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- é¡¹ç›®è¯¦æƒ… -->
  <view a:elif="{{project}}" class="detail-content">
    
    <!-- é¡¹ç›®å¤´éƒ¨ -->
    <view class="project-header">
      <view class="project-title">{{project.name}}</view>
      <view class="project-meta">
        <view class="meta-item">
          <text class="meta-label">æ¸¸æˆç±»å‹ï¼š</text>
          <text class="meta-value">{{project.game_type_name}}</text>
        </view>
        <view class="meta-item">
          <text class="meta-label">å†…å®¹ç±»å‹ï¼š</text>
          <text class="meta-value">{{project.content_type_name}}</text>
        </view>
        <view class="meta-item">
          <text class="meta-label">AI æ¨¡å‹ï¼š</text>
          <text class="meta-value">{{project.ai_model_name}}</text>
        </view>
        <view class="meta-item">
          <text class="meta-label">åˆ›å»ºæ—¶é—´ï¼š</text>
          <text class="meta-value">{{project.created_at}}</text>
        </view>
      </view>
    </view>

    <!-- æè¿°ä¿¡æ¯ -->
    <view a:if="{{project.description}}" class="card">
      <view class="card-title">ğŸ“ é¡¹ç›®æè¿°</view>
      <view class="card-content">
        <text class="description-text">{{project.description}}</text>
      </view>
    </view>

    <!-- ç”Ÿæˆçš„å†…å®¹ -->
    <view class="card">
      <view class="card-header">
        <text class="card-title">âœ¨ ç”Ÿæˆçš„å†…å®¹</text>
        <text class="copy-btn" onTap="copyContent">å¤åˆ¶</text>
      </view>
      <view class="card-content">
        <text class="content-text" selectable="true">{{project.content || project.generated_content || 'æš‚æ— å†…å®¹'}}</text>
      </view>
    </view>

    <!-- ä¸–ç•Œè§‚å†…å®¹ï¼ˆå¦‚æœæœ‰ï¼‰ -->
    <view a:if="{{project.worldview}}" class="card">
      <view class="card-header">
        <text class="card-title">ğŸŒ ä¸–ç•Œè§‚è®¾å®š</text>
        <text class="copy-btn" onTap="copyWorldview">å¤åˆ¶</text>
      </view>
      <view class="card-content">
        <view class="worldview-section">
          <text class="section-title">æ ‡é¢˜</text>
          <text class="section-content">{{project.worldview.title}}</text>
        </view>
        <view a:if="{{project.worldview.history}}" class="worldview-section">
          <text class="section-title">å†å²èƒŒæ™¯</text>
          <text class="section-content" selectable="true">{{project.worldview.history}}</text>
        </view>
        <view a:if="{{project.worldview.geography}}" class="worldview-section">
          <text class="section-title">åœ°ç†ç¯å¢ƒ</text>
          <text class="section-content" selectable="true">{{project.worldview.geography}}</text>
        </view>
        <view a:if="{{project.worldview.culture}}" class="worldview-section">
          <text class="section-title">æ–‡åŒ–ä½“ç³»</text>
          <text class="section-content" selectable="true">{{project.worldview.culture}}</text>
        </view>
      </view>
    </view>

    <!-- è§’è‰²ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰ -->
    <view a:if="{{project.characters && project.characters.length > 0}}" class="card">
      <view class="card-title">ğŸ‘¥ è§’è‰²åˆ—è¡¨</view>
      <view class="card-content">
        <view a:for="{{project.characters}}" a:key="id" class="character-item">
          <view class="character-header">
            <text class="character-name">{{item.name}}</text>
            <text class="character-role">{{item.role}}</text>
          </view>
          <view a:if="{{item.personality}}" class="character-detail">
            <text class="detail-label">æ€§æ ¼ï¼š</text>
            <text class="detail-value">{{item.personality}}</text>
          </view>
          <view a:if="{{item.background}}" class="character-detail">
            <text class="detail-label">èƒŒæ™¯ï¼š</text>
            <text class="detail-value" selectable="true">{{item.background}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="btn btn-secondary" onTap="shareProject">
        <text>ğŸ“¤ åˆ†äº«é¡¹ç›®</text>
      </button>
      <button class="btn btn-primary" onTap="exportProject">
        <text>ğŸ“¥ å¯¼å‡ºå†…å®¹</text>
      </button>
    </view>

    <!-- è¿”å›æŒ‰é’® -->
    <view class="back-button">
      <button class="btn btn-secondary" onTap="goBack">
        <text>â† è¿”å›åˆ—è¡¨</text>
      </button>
    </view>

  </view>

  <!-- é”™è¯¯çŠ¶æ€ -->
  <view a:else class="empty-state">
    <text class="empty-icon">âŒ</text>
    <text class="empty-text">é¡¹ç›®ä¸å­˜åœ¨æˆ–åŠ è½½å¤±è´¥</text>
    <button class="btn btn-primary mt-20" onTap="goBack">
      <text>è¿”å›åˆ—è¡¨</text>
    </button>
  </view>

</view>
